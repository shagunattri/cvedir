const mongoose = require('mongoose');

const vulnerabilitySchema = new mongoose.Schema({
  cveID: { type: String, required: true, unique: true },
  vendorProject: { type: String, required: true },
  product: { type: String, required: true },
  vulnerabilityName: { type: String, required: true },
  dateAdded: { type: Date, required: true },
  shortDescription: { type: String, required: true },
  requiredAction: { type: String, required: true },
  dueDate: { type: Date, required: true },
  knownRansomwareCampaignUse: { type: String, required: true },
  notes: { type: String, required: true },
  cwes: { type: [String], required: true },
}, { timestamps: true });

// Optionally, you can define a method to format your data if needed
vulnerabilitySchema.methods.toJSON = function() {
  const vulnerability = this;
  const vulnerabilityObject = vulnerability.toObject();
  
  // You can format date fields here if needed
  vulnerabilityObject.dateAdded = vulnerabilityObject.dateAdded.toISOString();
  vulnerabilityObject.dueDate = vulnerabilityObject.dueDate.toISOString();
  
  return vulnerabilityObject;
};

const Vulnerability = mongoose.model('Vulnerability', vulnerabilitySchema);
module.exports = Vulnerability;